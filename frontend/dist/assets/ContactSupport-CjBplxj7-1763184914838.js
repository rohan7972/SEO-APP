import{j as a}from"./app-bridge-Dll4AwN--1763184914838.js";import{r as w}from"./react-vendor-tAaa2TlE-1763184914838.js";import{u as U}from"./useShopApi-B3ws2q6b-1763184914838.js";import{B as g,a as P,T as f,d as $,C as _,I as L,h as T,z as I,b as W}from"./polaris-DkgsK6SL-1763184914838.js";class x{constructor(s=0,t="Network Error"){this.status=s,this.text=t}}const G=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,s)=>Promise.resolve(localStorage.setItem(e,s)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},l={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:G()},R=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},J=(e,s="https://api.emailjs.com")=>{if(!e)return;const t=R(e);l.publicKey=t.publicKey,l.blockHeadless=t.blockHeadless,l.storageProvider=t.storageProvider,l.blockList=t.blockList,l.limitRate=t.limitRate,l.origin=t.origin||s},B=async(e,s,t={})=>{const n=await fetch(l.origin+e,{method:"POST",headers:t,body:s}),i=await n.text(),d=new x(n.status,i);if(n.ok)return d;throw d},C=(e,s,t)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!s||typeof s!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},Q=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},E=e=>e.webdriver||!e.languages||e.languages.length===0,q=()=>new x(451,"Unavailable For Headless Browser"),Y=(e,s)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof s!="string")throw"The BlockList watchVariable has to be a string"},X=e=>{var s;return!((s=e.list)!=null&&s.length)||!e.watchVariable},Z=(e,s)=>e instanceof FormData?e.get(s):e[s],M=(e,s)=>{if(X(e))return!1;Y(e.list,e.watchVariable);const t=Z(s,e.watchVariable);return typeof t!="string"?!1:e.list.includes(t)},H=()=>new x(403,"Forbidden"),ee=(e,s)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(s&&typeof s!="string")throw"The LimitRate ID has to be a non-empty string"},te=async(e,s,t)=>{const n=Number(await t.get(e)||0);return s-Date.now()+n},K=async(e,s,t)=>{if(!s.throttle||!t)return!1;ee(s.throttle,s.id);const n=s.id||e;return await te(n,s.throttle,t)>0?!0:(await t.set(n,Date.now().toString()),!1)},z=()=>new x(429,"Too Many Requests"),se=async(e,s,t,n)=>{const i=R(n),d=i.publicKey||l.publicKey,y=i.blockHeadless||l.blockHeadless,m=i.storageProvider||l.storageProvider,v={...l.blockList,...i.blockList},h={...l.limitRate,...i.limitRate};return y&&E(navigator)?Promise.reject(q()):(C(d,e,s),Q(t),t&&M(v,t)?Promise.reject(H()):await K(location.pathname,h,m)?Promise.reject(z()):B("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:d,service_id:e,template_id:s,template_params:t}),{"Content-type":"application/json"}))},re=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},ae=e=>typeof e=="string"?document.querySelector(e):e,ie=async(e,s,t,n)=>{const i=R(n),d=i.publicKey||l.publicKey,y=i.blockHeadless||l.blockHeadless,m=l.storageProvider||i.storageProvider,v={...l.blockList,...i.blockList},h={...l.limitRate,...i.limitRate};if(y&&E(navigator))return Promise.reject(q());const u=ae(t);C(d,e,s),re(u);const p=new FormData(u);return M(v,p)?Promise.reject(H()):await K(location.pathname,h,m)?Promise.reject(z()):(p.append("lib_version","4.4.1"),p.append("service_id",e),p.append("template_id",s),p.append("user_id",d),B("/api/v1.0/email/send-form",p))},oe={init:J,send:se,sendForm:ie,EmailJSResponseStatus:x},F=[{label:"Bug Report",value:"bug_report"},{label:"Feature Request",value:"feature_request"},{label:"Billing Issue",value:"billing_issue"},{label:"General Question",value:"general_question"},{label:"Technical Support",value:"technical_support"}];function me({shop:e}){const{api:s}=U(),[t,n]=w.useState({name:"",email:"",subject:"general_question",message:"",file:null}),[i,d]=w.useState(!1),[y,m]=w.useState(null),[v,h]=w.useState(""),[u,p]=w.useState(null),S=e||((r,c="")=>{try{return new URLSearchParams(window.location.search).get(r)||c}catch{return c}})("shop","");w.useEffect(()=>{D()},[S]);const D=async()=>{try{const r=await s(`/api/shop/info?shop=${encodeURIComponent(S)}`);p(r),n(c=>({...c,name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||""}))}catch(r){console.error("[ContactSupport] Error loading shop info:",r)}},k=(r,c)=>{n(o=>({...o,[r]:c}))},O=r=>{if(r.length>0){const c=r[0];if(c.size>500*1024){m("error"),h("File size must be less than 500KB");return}n(o=>({...o,file:c}))}},V=r=>new Promise((c,o)=>{const j=new FileReader;j.readAsDataURL(r),j.onload=()=>c(j.result),j.onerror=b=>o(b)}),N=()=>t.name.trim()?t.email.trim()?t.message.trim()?!0:(m("error"),h("Please enter your message"),!1):(m("error"),h("Please enter your email"),!1):(m("error"),h("Please enter your name"),!1),A=async r=>{var c;if(r.preventDefault(),!!N()){d(!0),m(null),h("");try{let o={name:t.name,email:t.email,subject:((c=F.find(b=>b.value===t.subject))==null?void 0:c.label)||t.subject,message:t.message,shop_name:(u==null?void 0:u.name)||S,shop_url:`https://${S}`,time:new Date().toLocaleString()};if(t.file)try{const b=await V(t.file);o.file_name=t.file.name,o.file_size=`${(t.file.size/1024).toFixed(1)} KB`,o.file_type=t.file.type,o.file_data=b}catch(b){console.error("[ContactSupport] Error converting file to base64:",b),o.message+=`

ðŸ“Ž ATTACHED FILE (conversion failed):
Name: ${t.file.name}
Size: ${(t.file.size/1024).toFixed(1)} KB
Type: ${t.file.type}`}console.log("[ContactSupport] Sending email with params:",o);const j=await oe.send("service_c8j657n","template_zrftkfg",o,"-0N7g1SCh9fSknb6q");console.log("[ContactSupport] Email sent successfully:",j),m("success"),h("Message sent successfully! We'll get back to you within 24 hours."),n({name:(u==null?void 0:u.name)||"",email:(u==null?void 0:u.email)||"",subject:"general_question",message:"",file:null})}catch(o){console.error("[ContactSupport] Error sending email:",o),console.error("[ContactSupport] Error details:",{message:o.message,status:o.status,text:o.text,stack:o.stack}),m("error"),h(`Failed to send message: ${o.message||"Unknown error"}`)}finally{d(!1)}}};return a.jsx(g,{padding:"400",children:a.jsxs(P,{gap:"400",children:[a.jsx(f,{variant:"bodyMd",tone:"subdued",children:"Need help? Send us a message and we'll get back to you within 24 hours."}),y&&a.jsx($,{tone:y==="success"?"success":"critical",children:v}),a.jsx(_,{children:a.jsx(g,{padding:"400",children:a.jsx("form",{onSubmit:A,children:a.jsxs(P,{gap:"400",children:[a.jsxs(L,{gap:"400",wrap:!0,children:[a.jsx(g,{flexGrow:1,children:a.jsx(T,{label:"Name",value:t.name,onChange:r=>k("name",r),placeholder:"Your name",required:!0,disabled:i})}),a.jsx(g,{flexGrow:1,children:a.jsx(T,{label:"Email",type:"email",value:t.email,onChange:r=>k("email",r),placeholder:"your@email.com",required:!0,disabled:i})})]}),a.jsx(I,{label:"Subject",options:F,value:t.subject,onChange:r=>k("subject",r),disabled:i}),a.jsx(T,{label:"Message",value:t.message,onChange:r=>k("message",r),multiline:4,placeholder:"Describe your issue or question...",required:!0,disabled:i}),a.jsxs(g,{children:[a.jsx(f,{as:"label",variant:"bodyMd",fontWeight:"medium",children:"Attach File (Optional)"}),a.jsx(g,{paddingBlockStart:"100",children:a.jsx("input",{type:"file",onChange:r=>O(r.target.files),disabled:i,style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",width:"100%"}})}),a.jsx(f,{variant:"bodySm",tone:"subdued",children:"Any file type allowed â€¢ Maximum file size: 500KB"})]}),a.jsx(L,{gap:"200",align:"end",children:a.jsx(W,{variant:"primary",submit:!0,loading:i,disabled:i,children:i?"Sending...":"Send Message"})})]})})})}),a.jsx(_,{children:a.jsx(g,{padding:"400",children:a.jsxs(P,{gap:"200",children:[a.jsx(f,{as:"h3",variant:"headingMd",children:"Other Ways to Reach Us"}),a.jsx(f,{variant:"bodyMd",tone:"subdued",children:"â€¢ Email: indexaize@gmail.com"}),a.jsx(f,{variant:"bodyMd",tone:"subdued",children:"â€¢ Response time: Within 24 hours"}),a.jsxs(f,{variant:"bodyMd",tone:"subdued",children:["â€¢ Include your shop name: ",S]})]})})})]})})}export{me as default};
